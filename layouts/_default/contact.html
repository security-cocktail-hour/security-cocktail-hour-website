{{ define "main" }}

<!-- Page Header -->
<section class="section" style="background: linear-gradient(135deg, #436098 0%, #6A8CC7 100%); color: white; padding: 3rem 0;">
  <div class="container" style="max-width: 800px; text-align: center;">
    <h1 style="color: white; margin-bottom: 1rem;">Get In Touch</h1>
    <p style="font-size: 1.125rem;">
      We'd love to hear from you. Whether you're interested in being a guest, exploring
      partnership opportunities, or just want to say hello—reach out!
    </p>
  </div>
</section>

<!-- Contact Form and Info -->
<section class="section">
  <div class="container">
    <div class="grid grid-2" style="gap: 3rem; max-width: 1000px; margin: 0 auto; align-items: start;">

      <!-- Contact Form -->
      <div>
        <h2>Send Us a Message</h2>
        <form action="https://formspree.io/f/mrbyrgrv" method="POST" class="contact-form">

          <div class="form-group">
            <label for="name">Name *</label>
            <input type="text" id="name" name="name" required>
          </div>

          <div class="form-group">
            <label for="email">Email *</label>
            <input type="email" id="email" name="email" required>
          </div>

          <div class="form-group">
            <label for="subject">Subject *</label>
            <select id="subject" name="subject" required>
              <option value="">Select a subject...</option>
              <option value="guest">Guest Submission</option>
              <option value="partnership">Partnership Opportunity</option>
              <option value="consulting">Consulting Inquiry</option>
              <option value="sponsorship">Sponsorship</option>
              <option value="press">Press Inquiry</option>
              <option value="general">General Question</option>
            </select>
          </div>

          <div class="form-group">
            <label for="message">Message *</label>
            <textarea id="message" name="message" rows="6" required></textarea>
          </div>

          <!-- Formspree status messages will appear here -->
          <div id="form-status" style="margin-bottom: 1rem;"></div>

          <button type="submit" class="btn btn-primary" style="width: 100%;">Send Message</button>

          <p style="font-size: 0.75rem; margin-top: 1rem; color: rgba(45, 45, 45, 0.6);">
            * Required fields. We typically respond within 2-3 business days.
          </p>
        </form>
      </div>

      <!-- Contact Information -->
      <div>
        <h2>Other Ways to Reach Us</h2>

        <div class="card" style="margin-bottom: 1.5rem; background: #F5F5F5;">
          <div class="card-content">
            <h4>Email</h4>
            <p><a href="mailto:feedback@securitycocktailhour.com">feedback@securitycocktailhour.com</a></p>
          </div>
        </div>

        <div class="card" style="margin-bottom: 1.5rem; background: #F5F5F5;">
          <div class="card-content">
            <h4>Social Media</h4>
            <p>Follow us on Twitter/X: <a href="https://twitter.com/SecCocktailHour" target="_blank" rel="noopener">@SecCocktailHour</a></p>
          </div>
        </div>

        <div class="card" style="background: #F5F5F5;">
          <div class="card-content">
            <h4>Response Time</h4>
            <p style="font-size: 0.875rem;">
              We review all messages and aim to respond within 2-3 business days.
              For urgent matters, please use the email address above.
            </p>
          </div>
        </div>

        <!-- Guest Submission Info -->
        <div style="margin-top: 2rem; padding: 1.5rem; border-left: 4px solid #436098; background: #F5F5F5;">
          <h4>Interested in Being a Guest?</h4>
          <p style="font-size: 0.875rem; margin-bottom: 1rem;">
            We're always looking for great people in cybersecurity and related fields with unique insights to share. If you'd like to be a guest on the show, please use the contact form and include:
          </p>
          <ul style="font-size: 0.875rem; margin-left: 1.5rem;">
            <li>Topics you'd like to discuss</li>
            <li>Your area of expertise</li>
            <li>Your LinkedIn profile</li>
          </ul>
        </div>

      </div>

    </div>
  </div>
</section>

{{ end }}

{{ define "scripts" }}
<script>
// Enhanced Formspree submission handler with AJAX
document.querySelector('.contact-form').addEventListener('submit', async function(e) {
  e.preventDefault();

  const form = e.target;
  const formData = new FormData(form);
  const submitButton = form.querySelector('button[type="submit"]');
  const statusDiv = document.getElementById('form-status');

  // Disable submit button and show loading state
  submitButton.disabled = true;
  submitButton.textContent = 'Sending...';
  statusDiv.innerHTML = '';

  try {
    const response = await fetch(form.action, {
      method: 'POST',
      body: formData,
      headers: {
        'Accept': 'application/json'
      }
    });

    if (response.ok) {
      // Success
      statusDiv.innerHTML = '<div style="padding: 1rem; background: #d4edda; color: #155724; border-radius: 4px; margin-bottom: 1rem;">✓ Thank you! Your message has been sent successfully. We\'ll get back to you within 2-3 business days.</div>';
      form.reset();
    } else {
      // Error from Formspree
      const data = await response.json();
      if (data.errors) {
        statusDiv.innerHTML = '<div style="padding: 1rem; background: #f8d7da; color: #721c24; border-radius: 4px; margin-bottom: 1rem;">⚠ ' + data.errors.map(error => error.message).join(', ') + '</div>';
      } else {
        throw new Error('Form submission failed');
      }
    }
  } catch (error) {
    // Network or other error
    statusDiv.innerHTML = '<div style="padding: 1rem; background: #f8d7da; color: #721c24; border-radius: 4px; margin-bottom: 1rem;">⚠ There was a problem sending your message. Please try again or email us directly at feedback@securitycocktailhour.com</div>';
  } finally {
    // Re-enable submit button
    submitButton.disabled = false;
    submitButton.textContent = 'Send Message';
  }
});
</script>
{{ end }}
